all: main.elf

CPU = msp430g2553
CFLAGS = -mmcu=${CPU} -Os -I ../h
LDFLAGS = -L/opt/ti/msp430_gcc/include -L../lib
CC = msp430-elf-gcc
AS = msp430-elf-as
AR = msp430-elf-ar


../lib/libLcd.a: ../lcdLib/font-11x16.o ../lcdLib/font-5x7.o ../lcdLib/font-8x12.o ../lcdLib/lcdutils.o ../lcdLib/lcddraw.o
	$(AS) -mmcu=${CPU} -o $@ $<

main.o: main.c

main.elf: main.o wdt_handler.o ../lib/libLcd.a
	$(CC) $(CFLAGS) $(LDFLAGS) $^ -o $@ -lTimer

load: main.elf
	msp430loader.sh $^

install: ../lib/libLcd.a
	mkdir -p ../h ../lib
	cp ../lcdLib/*.h ../h

clean:
	rm -f *.o *.elf
